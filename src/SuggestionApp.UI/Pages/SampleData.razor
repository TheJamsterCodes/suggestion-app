@namespace SuggestionApp.UI.Pages

@page "/SampleData"
@inject ICategoryService categorySvc
@inject IStatusService statusSvc

<h2>SampleData</h2>

<hr />

@if (areCategoriesCreated) {
    <h4>Categories have been created!</h4>

    <hr />

    <dl>
        @foreach (Category category in categories)
        {
            <dt>@category.Name</dt>
            <dd>@category.Description</dd>
        }
    </dl>

} else {
    <button class="btn btn-primary" @onclick="CreateCategories">Create Categories</button>
}

<hr />

@if (areStatusesCreated) {
    <h4>Statuses have been created!</h4>

    <dl>
        @foreach (Status status in statuses)
        {
            <dt>@status.Name</dt>
            <dd>@status.Description</dd>
        }
    </dl>

} else {
    <button class="btn btn-primary" @onclick="CreateStatuses">Create Statuses</button>
}

@code {
    private bool areCategoriesCreated = false;
    private bool areStatusesCreated = false;

    private IEnumerable<Category> categories;
    private IEnumerable<Status> statuses;
    
    private async Task CreateCategories()
    {
        categories = await categorySvc.Get();

        if (!categories.Any())
        {
            categorySvc.Create(MockCategory.Categories.ToList());
        }

        if (categories.Any()) areCategoriesCreated = true;
    }

    private async Task CreateStatuses()
    {
        statuses = await statusSvc.Get();

        if (!statuses.Any())
        {
            statusSvc.Create(MockStatus.Statuses.ToList());
        }

        if (statuses.Any()) areStatusesCreated = true;
    }    
}